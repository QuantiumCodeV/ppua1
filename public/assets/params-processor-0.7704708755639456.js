let PUMBLE_UTM_PARAMS_KEY="pmbl-utm-params",PUMBLE_UTM_ANALYTICS_PARAMS_KEY="pmbl-utm-analytics-params",PUMBLE_GCLID_SAVED_AT_KEY="pumbl-gclid-saved-at",PUMBLE_UTM_ATTRIBUTION_KEY="pmbl-utm-attribution-params",GCLID_EXPIRATION_DAYS=90,storeUtmParams=()=>{try{var t=new URLSearchParams(window.location.search);let a=[];t.forEach((t,e)=>{!e.startsWith("utm_")&&"gclid"!==e||a.push({key:e,value:t})}),a.length&&localStorage.setItem(PUMBLE_UTM_PARAMS_KEY,JSON.stringify(a))}catch(t){console.log("issue storing utm params",t)}},findUtmParamsForAppStore=(e,t)=>{try{var a=t||[];for(let t=0;t<a.length;t++)if(a[t].key===e)return a[t].value;return""}catch(t){console.log("issue finding utm params",t)}},shouldSaveNewGclid=t=>!t.gclid||!!(t=localStorage.getItem(PUMBLE_GCLID_SAVED_AT_KEY))&&(t=new Date(t).getTime(),(new Date).getTime()-t>=864e5*GCLID_EXPIRATION_DAYS),storeUtmCpcParams=()=>{try{if(localStorage.getItem(PUMBLE_UTM_ANALYTICS_PARAMS_KEY))try{var t,e=JSON.parse(localStorage.getItem(PUMBLE_UTM_ANALYTICS_PARAMS_KEY));shouldSaveNewGclid(e)&&((t=new URLSearchParams(window.location.search).get("gclid"))?(e.gclid=t,localStorage.setItem(PUMBLE_GCLID_SAVED_AT_KEY,(new Date).toISOString())):delete e.gclid,localStorage.setItem(PUMBLE_UTM_ANALYTICS_PARAMS_KEY,JSON.stringify(e)))}catch(t){}else{var a=new URLSearchParams(window.location.search),m=a.get("utm_medium"),r=a.get("utm_source"),o=a.get("utm_campaign"),i=a.get("utm_term"),c=a.get("gclid"),l=a.get("utm_cmpid"),s=a.get("utm_agid"),n=a.get("device"),_=window.location.origin+(1<window.location.pathname?.length?window.location.pathname:"");m&&r&&(localStorage.setItem(PUMBLE_UTM_ANALYTICS_PARAMS_KEY,JSON.stringify({utmMedium:m,utmSource:r,utmCampaign:o,utmTerm:i,landingUrl:_,gclid:c,utmAgid:s,device:n,utmCmpid:l})),localStorage.setItem(PUMBLE_GCLID_SAVED_AT_KEY,(new Date).toISOString())),localStorage.getItem(PUMBLE_UTM_ATTRIBUTION_KEY)||localStorage.setItem(PUMBLE_UTM_ATTRIBUTION_KEY,m&&r&&("cpc"===m||"paid_social"===m)?"fc":"oc")}}catch(t){console.log("issue storing cpc utm params",t)}},attachUtmParams=()=>{try{var t=localStorage.getItem(PUMBLE_UTM_PARAMS_KEY),e=t?JSON.parse(t):[];if(e.length){var a=document.getElementsByTagName("a");if(a&&a.length)for(let t=0;t<a.length;t++){var m,r,o,i,c,l=a[t];l.href.startsWith("https://play.google.com/store/apps/details?id=com.pumble")&&(m=e.map(t=>t.key+"="+t.value).join("&"),l.href+="&referrer="+encodeURIComponent(m)),l.href.startsWith("https://apps.apple.com/us/app/pumble/id1536136725")&&(r=findUtmParamsForAppStore("utm_source",e),o=findUtmParamsForAppStore("utm_medium",e),i=findUtmParamsForAppStore("utm_campaign",e),c=findUtmParamsForAppStore("utm_content",e),l.href="https://click.google-analytics.com/redirect?tid=262760258&url=https%3A%2F%2Fitunes.apple.com%2Fus%2Fapp%2Fpumble%2Fid1536136725&aid=com.pumble.app&idfa={idfa}&cs="+r+"&cm="+o+"&cn="+i+"&cc="+c+"&ck=pumble&anid=admob&hash=md5")}}}catch(t){console.log("issue attaching app store links",t)}};window.addEventListener("load",()=>{storeUtmParams(),storeUtmCpcParams(),attachUtmParams()});